<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Profile | SaveTrack</title>
<!--    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
<!--    <link rel="stylesheet" th:href="@{/css/profile.css}">-->
    <link rel="stylesheet" href="/css/profile.css">
    <link rel="stylesheet" href="/css/dashboard.css">
    <link rel="icon" href="/images/favicon.png" type="image/png">


</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark bg-success fixed-top shadow">
    <div class="container-fluid d-flex justify-content-between">
        <a class="navbar-brand fw-bold" th:href="'#'">SaveTrack</a>
        <button class="btn btn-outline-light" id="sidebarToggle"><i class="bi bi-list fs-4"></i></button>
    </div>
</nav>

<div id="sidebar-wrapper">
    <div class="sidebar-heading text-center pt-3 pb-1">
        <img th:src="@{${user.profilePhoto}}" class="rounded-circle" border="2px" width="100" height="90" alt="Profile Photo" />
        <i> <h6 class="mt-2" th:text="${user.name}">User Name</h6> </i>
    </div>
    <div class="list-group list-group-flush">
        <a th:href="@{/profile}" id="profileLink" class="list-group-item list-group-item-action sidebar-link">ğŸ‘©â€ğŸ’» Profile</a>
        <a th:href="@{/dashboard}" class="list-group-item list-group-item-action sidebar-link">ğŸ“Š Dashboard</a>
        <a th:href="@{/income}" class="list-group-item list-group-item-action sidebar-link">ğŸ’° Add Income</a>
        <a th:href="@{/expense}" class="list-group-item list-group-item-action sidebar-link">ğŸ’¸ Add Expense</a>
        <a th:href="@{/debt}" class="list-group-item list-group-item-action sidebar-link">ğŸ§¾ Debt Recovery</a>
        <a th:href="@{/export}" class="list-group-item list-group-item-action sidebar-link">ğŸ“ Export CSV Report</a>
        <a th:href="@{/logout}" class="list-group-item list-group-item-action text-danger">ğŸšª Logout</a>
    </div>
</div>

<div id="page-content-wrapper" class="container-fluid mt-2">
    <div class="row justify-content-center align-items-start">

        <div class="col-md-4 text-center mb-4">
            <img id="profilePhotoPreview" src="/images/default-avatar.png" class="profile-img" alt="Profile Photo">
            <button class="btn btn-success text-white mt-3" data-bs-toggle="modal" data-bs-target="#photoModal">Change Profile Photo</button>
        </div>

        <div class="col-md-6">
            <div class="profile-card">
                <p><strong>Name:</strong> <span id="nameText"></span></p>
                <p><strong>Email:</strong> <span id="emailText"></span></p>
                <p><strong>Phone:</strong> <span id="phoneText"></span></p>
                <p><strong>Address:</strong> <span id="addressText"></span></p>
                <button class="btn btn-danger text-white mt-3" data-bs-toggle="modal" data-bs-target="#updateModal">Update Details</button>
            </div>
        </div>
    </div>
    <footer class="text-center text-muted py-4">
        "Beware of little expenses. A small leak will sink a great ship" â€” Benjamin Franklin
    </footer>
</div>

<div class="modal fade" id="updateModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
        <form id="updateProfileForm" class="modal-content">
            <div class="modal-header bg-success text-white">
                <h5 class="modal-title">Update Profile</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <label for="editName" class="form-label">Name</label>
                <input id="editName" type="text" class="form-control mb-2" name="name" required placeholder="Name">
                <label for="editPhone" class="form-label">Phone Number</label>
                <input id="editPhone" type="text" class="form-control mb-2" name="phoneNumber" pattern="\d{10}" required placeholder="Phone Number">
                <label for="editAddress" class="form-label">Address</label>
                <textarea id="editAddress" class="form-control mb-2" name="address" required placeholder="Address"></textarea>
<!--                <label class="form-label">Change Profile Photo (optional)</label>-->
<!--                <input type="file" class="form-control" name="photo" accept="image/*">-->
            </div>
            <div class="modal-footer">
                <button type="submit" class="btn btn-success">Save Changes</button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            </div>
        </form>
    </div>
</div>

<div class="modal fade" id="photoModal" tabindex="-1">
    <div class="modal-dialog">
        <form id="photoForm" class="modal-content">
            <div class="modal-header bg-success text-white">
                <h5 class="modal-title">Change Profile Photo</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <input type="file" class="form-control" name="photo" required accept="image/*">
            </div>
            <div class="modal-footer">
                <button type="submit" class="btn btn-success">Upload</button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            </div>
        </form>
    </div>
</div>

<!--<script th:src="@{/js/bootstrap.bundle.min.js}"></script>-->
<!--<script th:src="@{/js/profile.js}"></script>-->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="/js/profile.js"></script>

<script th:inline="javascript">
    document.addEventListener("DOMContentLoaded", () => {
    const currentPath = window.location.pathname;

    document.querySelectorAll(".sidebar-link").forEach(link => {
      if (link.getAttribute("href") === currentPath) {
        link.classList.add("active");
      }
    });
    });
</script>

</body>
</html>
